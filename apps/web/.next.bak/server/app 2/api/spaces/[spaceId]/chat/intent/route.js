"use strict";(()=>{var a={};a.id=3265,a.ids=[3265],a.modules={261:a=>{a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:a=>{a.exports=require("node:buffer")},10263:(a,b,c)=>{let d;c.d(b,{Ge:()=>n,Sj:()=>i.Sj,ai:()=>o,db:()=>l,oc:()=>i.oc});var e=c(9613),f=c(79191),g=c(42626),h=c(74980);c(65329);var i=c(57820);let j={apiKey:"AIzaSyDMDHXJ8LcWGXz05ipPTNvA-fRi9nfdzbQ",authDomain:"hive-9265c.firebaseapp.com",projectId:"hive-9265c",storageBucket:"hive-9265c.appspot.com",messagingSenderId:"573191826528",appId:"1:573191826528:web:1d5eaeb8531276e4c1a705",measurementId:"G-NK3E12MSFD"};{let a=["apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId"].filter(a=>!j[a]);if(a.length>0)throw console.error(`Missing Firebase environment variables: ${a.join(", ")}`),Error(`Firebase configuration error: ${a.join(", ")} required`)}if(j.projectId?.includes("demo")||j.projectId?.includes("test")||j.authDomain?.includes("localhost"))throw Error("Development Firebase configuration detected in production!");d=(0,e.Dk)().length?(0,e.Sx)():(0,e.Wp)(j);let k=(0,f.xI)(d),l=(0,g._A)(d,{experimentalForceLongPolling:!1,cacheSizeBytes:0x3200000}),m=(0,h.c7)(d);if("true"===process.env.NEXT_PUBLIC_USE_FIREBASE_EMULATOR){let a=process.env.NEXT_PUBLIC_EMULATOR_HOST||"localhost";k.emulatorConfig||(0,f.Wq)(k,`http://${a}:9099`,{disableWarnings:!0}),l._settings?.host?.includes("localhost")||(0,g.vN)(l,a,8080),m._host?.includes("localhost")||(0,h.nb)(m,a,9199)}let n=(a,b)=>!!a&&!!b&&a===b,o=(0,i.lS)(d,{backend:new i.C8})},10846:a=>{a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12665:(a,b,c)=>{c.d(b,{Ku:()=>g,NN:()=>h});var d=c(38929),e=c(91714);let f={guest:0,member:1,moderator:2,leader:3,admin:4,owner:5};async function g(a,b,c="member"){try{var h;let g="admin"===c?"leader":c,i=await d.dbAdmin.collection("spaces").doc(a).get();if(!i.exists)return{hasPermission:!1,code:"NOT_FOUND",error:"Space not found"};let j=i.data(),k={id:a,name:j.name||"Unnamed Space",campusId:j.campusId||j.schoolId,isPublic:!j.isPrivate&&"private"!==j.visibility,category:j.category||j.type||"general"};if("guest"===g){if(!b)return k.isPublic?{hasPermission:!0,space:k}:{hasPermission:!1,code:"FORBIDDEN",error:"Authentication required",space:k};return{hasPermission:!0,space:k}}if(!b)return{hasPermission:!1,code:"FORBIDDEN",error:"Authentication required",space:k};let l=`${a}_${b}`,m=await d.dbAdmin.collection("spaceMembers").doc(l).get(),n=null;if(m.exists){let a=m.data();n={spaceId:a.spaceId,userId:a.userId,role:a.role,isSuspended:!0===a.isSuspended,isActive:!1!==a.isActive,joinedAt:a.joinedAt?.toDate?.()||new Date,campusId:a.campusId}}else{let c=await d.dbAdmin.collection("spaceMembers").where("spaceId","==",a).where("userId","==",b).limit(1).get();if(!c.empty){let a=c.docs[0].data();n={spaceId:a.spaceId,userId:a.userId,role:a.role,isSuspended:!0===a.isSuspended,isActive:!1!==a.isActive,joinedAt:a.joinedAt?.toDate?.()||new Date,campusId:a.campusId}}}if(!n&&j.leaders?.includes(b)&&(e.vF.debug("User found in space leaders array",{spaceId:a,userId:b}),n={spaceId:a,userId:b,role:"leader",isSuspended:!1,isActive:!0,joinedAt:new Date}),e.vF.info("Checking space ownership",{spaceId:a,userId:b,createdBy:j.createdBy,isMatch:j.createdBy===b,hasMembership:!!n}),n||j.createdBy!==b||(e.vF.info("User is space owner via createdBy",{spaceId:a,userId:b}),n={spaceId:a,userId:b,role:"owner",isSuspended:!1,isActive:!0,joinedAt:new Date}),!n)return{hasPermission:!1,code:"NOT_MEMBER",error:"You are not a member of this space",space:k};if(n.isSuspended)return{hasPermission:!1,code:"SUSPENDED",error:"Your membership has been suspended",space:k,membership:{role:n.role,isSuspended:!0,joinedAt:n.joinedAt}};if(!n.isActive)return{hasPermission:!1,code:"FORBIDDEN",error:"Your membership is inactive",space:k};if(h=n.role,!(f[h]>=f[g]))return{hasPermission:!1,code:"FORBIDDEN",error:`This action requires ${g} role or higher`,space:k,membership:{role:n.role,isSuspended:!1,joinedAt:n.joinedAt}};return{hasPermission:!0,role:n.role,space:k,membership:{role:n.role,isSuspended:!1,joinedAt:n.joinedAt}}}catch(d){return e.vF.error("Error checking space permission",{spaceId:a,userId:b??void 0,requiredRole:c,error:d instanceof Error?d.message:"Unknown error"}),{hasPermission:!1,code:"FORBIDDEN",error:"Failed to check permissions"}}}async function h(a,b){try{let c=`${a}_${b}`,e=await d.dbAdmin.collection("spaceMembers").doc(c).get();if(e.exists){let a=e.data();return{spaceId:a.spaceId,userId:a.userId,role:a.role,isSuspended:!0===a.isSuspended,isActive:!1!==a.isActive,joinedAt:a.joinedAt?.toDate?.()||new Date,campusId:a.campusId}}let f=await d.dbAdmin.collection("spaceMembers").where("spaceId","==",a).where("userId","==",b).limit(1).get();if(f.empty)return null;let g=f.docs[0].data();return{spaceId:g.spaceId,userId:g.userId,role:g.role,isSuspended:!0===g.isSuspended,isActive:!1!==g.isActive,joinedAt:g.joinedAt?.toDate?.()||new Date,campusId:g.campusId}}catch(c){return e.vF.error("Error getting space membership",{spaceId:a,userId:b,error:c instanceof Error?c.message:"Unknown error"}),null}}},14276:a=>{a.exports=import("firebase-admin/auth")},14985:a=>{a.exports=require("dns")},19121:a=>{a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:a=>{a.exports=require("process")},19789:(a,b,c)=>{c.d(b,{Q:()=>d});class d{constructor(a,b,c){if(a&&b)throw Error("InvalidOperation: A result cannot be successful and contain an error");if(!a&&!b)throw Error("InvalidOperation: A failing result needs to contain an error message");this.isSuccess=a,this.isFailure=!a,this._error=b,this._value=c,Object.freeze(this)}getValue(){if(!this.isSuccess)throw Error("Cannot get the value of an error result. Use error instead.");return this._value}get error(){return this._error}static ok(a){return new d(!0,null,a??null)}static fail(a){return new d(!1,a,null)}static combine(a){for(let b of a)if(b.isFailure)return b;return d.ok()}}},21820:a=>{a.exports=require("os")},27910:a=>{a.exports=require("stream")},28354:a=>{a.exports=require("util")},29021:a=>{a.exports=require("fs")},29294:a=>{a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29655:(a,b,c)=>{c.d(b,{C:()=>l,parseIntent:()=>h,shouldCreateComponent:()=>k});var d=c(35883),e=c(97338);let f=d.Sj.object({properties:{type:d.Sj.string(),confidence:d.Sj.number(),params:d.Sj.object({properties:{question:d.Sj.string(),options:d.Sj.array({items:d.Sj.string()}),allowMultiple:d.Sj.boolean(),eventTitle:d.Sj.string(),eventDate:d.Sj.string(),maxCapacity:d.Sj.number(),title:d.Sj.string(),targetDate:d.Sj.string(),content:d.Sj.string()}})}}),g=`You are an intent parser for a campus community platform (HIVE).
Your job is to detect if a message is a request to create an interactive component.

## Supported Component Types

POLL (type: "poll")
- Triggers: "create a poll", "let's vote", "poll for", "vote on", "quick poll"
- Extract: question, options (array), allowMultiple (true if "select multiple" mentioned)
- Example: "Let's vote on where to eat - pizza, sushi, or burgers" â†’ poll with 3 options

RSVP (type: "rsvp")
- Triggers: "set up rsvp", "registration for", "sign up for", "rsvp for", "attendance for"
- Extract: eventTitle, eventDate (ISO string), maxCapacity (if limit mentioned)
- Example: "RSVP for study session on Friday at 3pm" â†’ rsvp with title and date

COUNTDOWN (type: "countdown")
- Triggers: "countdown to", "timer for", "X days until", "countdown for"
- Extract: title, targetDate (ISO string)
- Example: "Countdown to finals - December 16th" â†’ countdown with target date

ANNOUNCEMENT (type: "announcement")
- Triggers: "announce", "announcement:", "ðŸ“¢", "@everyone"
- Extract: content (the announcement text)
- Example: "ðŸ“¢ Meeting moved to Room 201" â†’ announcement

NONE (type: "none")
- Regular conversation, questions, statements that aren't component requests
- Example: "How's everyone doing?" â†’ none
- Example: "What time is the meeting?" â†’ none (asking, not creating)

## Important Rules

1. Only detect clear creation intents - don't hallucinate components from casual mentions
2. If unsure, return type: "none" with low confidence
3. For polls, extract actual options from the message (don't make them up)
4. For dates, parse relative dates (tomorrow, Friday, next week) to ISO format
5. Confidence should be 0.0-1.0:
   - 0.9+ for explicit commands ("create a poll")
   - 0.7-0.9 for implicit but clear ("let's vote on")
   - 0.5-0.7 for ambiguous (might be question vs command)
   - <0.5 should return "none"

## Output Format

Return a JSON object with:
- type: "poll" | "rsvp" | "countdown" | "announcement" | "none"
- confidence: 0.0 to 1.0
- params: extracted parameters (only include relevant ones)

For "none" type, params should be empty object {}.`;async function h(a,b){if(a.length<5||a.length>2e3)return i(a);let c=function(a){var b;let c,d=a.toLowerCase().trim();return d.startsWith("/poll")||d.match(/^poll:\s*/i)?function(a){a.toLowerCase().trim();let b=a.match(/^\/poll\s+"([^"]+)"\s+(.+)$/i);if(b)return{type:"poll",confidence:.95,params:{question:b[1],options:b[2].split(/\s+/).filter(a=>a.length>0)},rawInput:a};let c=a.match(/^poll:\s*([^?]+\?)\s*[-â€“]\s*(.+)$/i);return c?{type:"poll",confidence:.9,params:{question:c[1].trim(),options:c[2].split(/[,;]/).map(a=>a.trim()).filter(a=>a.length>0)},rawInput:a}:{type:"poll",confidence:.7,params:{},rawInput:a}}(a):d.startsWith("/rsvp")||d.match(/^rsvp:/i)?function(a){let b=a.match(/^\/rsvp\s+"([^"]+)"(.*)$/i);if(b){let c=b[1],d=b[2],e={eventTitle:c},f=d.match(/--limit[=:]?\s*(\d+)/i);f&&(e.maxCapacity=parseInt(f[1],10));let g=d.match(/--date[=:]?\s*([^\s]+)/i);return g&&(e.eventDate=j(g[1])),{type:"rsvp",confidence:.95,params:e,rawInput:a}}return{type:"rsvp",confidence:.7,params:{},rawInput:a}}(a):d.startsWith("/countdown")||d.match(/^countdown:/i)?function(a){let b=a.match(/^\/countdown\s+"([^"]+)"\s+(.+)$/i);if(b)return{type:"countdown",confidence:.95,params:{title:b[1],targetDate:j(b[2])},rawInput:a};let c=a.match(/^countdown:\s*([^-]+)\s*[-â€“]\s*(.+)$/i);return c?{type:"countdown",confidence:.9,params:{title:c[1].trim(),targetDate:j(c[2].trim())},rawInput:a}:{type:"countdown",confidence:.7,params:{},rawInput:a}}(a):d.startsWith("/announce")||a.startsWith("\uD83D\uDCE2")?((c=b=a).toLowerCase().startsWith("/announce")&&(c=c.substring(9).trim()),c.startsWith("\uD83D\uDCE2")&&(c=c.substring(2).trim()),{type:"announcement",confidence:.95,params:{content:c},rawInput:b}):null}(a);if(c)return c;try{let c=(0,d.oc)(d.ai,{model:"gemini-2.0-flash",systemInstruction:g,generationConfig:{responseMimeType:"application/json",responseSchema:f,temperature:.1,maxOutputTokens:1024}}),h="";b?.spaceName&&(h+=`
Context: This message is in the "${b.spaceName}" space`,b.spaceCategory&&(h+=` (${b.spaceCategory})`),h+="."),b?.isLeader&&(h+="\nThe user is a space leader (can create components).");let j=`${h}

Message: "${a}"`,k=(await c.generateContent(j)).response.text(),l=JSON.parse(k),m=function(a,b){let c=a.type?.toLowerCase(),d=a.confidence??0,e=a.params??{};if(!["poll","rsvp","countdown","announcement","none"].includes(c))return i(b);let f={};return e.question&&(f.question=String(e.question)),Array.isArray(e.options)&&(f.options=e.options.map(String)),"boolean"==typeof e.allowMultiple&&(f.allowMultiple=e.allowMultiple),e.eventTitle&&(f.eventTitle=String(e.eventTitle)),e.eventDate&&(f.eventDate=new Date(String(e.eventDate))),"number"==typeof e.maxCapacity&&(f.maxCapacity=e.maxCapacity),e.title&&(f.title=String(e.title)),e.targetDate&&(f.targetDate=new Date(String(e.targetDate))),e.content&&(f.content=String(e.content)),{type:c,confidence:Math.max(0,Math.min(1,d)),params:f,rawInput:b}}(l,a);return e.v.debug("Intent parsed",{component:"ai-intent-parser",type:m.type,confidence:m.confidence,messagePreview:a.substring(0,50)}),m}catch(b){return e.v.error("Intent parsing failed",{component:"ai-intent-parser",error:b instanceof Error?b.message:"Unknown error",messagePreview:a.substring(0,50)}),i(a)}}function i(a){return{type:"none",confidence:1,params:{},rawInput:a}}function j(a){let b=a.toLowerCase().trim(),c=new Date;if("tomorrow"===b){let a=new Date(c);return a.setDate(a.getDate()+1),a.setHours(12,0,0,0),a}if("today"===b){let a=new Date(c);return a.setHours(23,59,0,0),a}if(b.includes("next week")){let a=new Date(c);return a.setDate(a.getDate()+7),a.setHours(12,0,0,0),a}let d=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].findIndex(a=>b.includes(a));if(-1!==d){let a=new Date(c),b=d-a.getDay();return b<=0&&(b+=7),a.setDate(a.getDate()+b),a.setHours(12,0,0,0),a}try{let b=new Date(a);if(!isNaN(b.getTime()))return b}catch{}}function k(a){return"none"!==a.type&&a.confidence>=.7}function l(a){switch(a.type){case"poll":if(a.params.question&&a.params.options?.length)return`Create poll: "${a.params.question}" with ${a.params.options.length} options?`;return"Create a poll?";case"rsvp":if(a.params.eventTitle)return`Create RSVP for "${a.params.eventTitle}"?`;return"Create an RSVP?";case"countdown":if(a.params.title&&a.params.targetDate)return`Create countdown to "${a.params.title}" (${a.params.targetDate.toLocaleDateString()})?`;return"Create a countdown?";case"announcement":return"Post announcement?";default:return""}}},33873:a=>{a.exports=require("path")},34631:a=>{a.exports=require("tls")},35883:(a,b,c)=>{c.d(b,{Sj:()=>d.Sj,ai:()=>d.ai,db:()=>d.db,oc:()=>d.oc});var d=c(10263)},39521:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{handler:()=>x,patchFetch:()=>w,routeModule:()=>y,serverHooks:()=>B,workAsyncStorage:()=>z,workUnitAsyncStorage:()=>A});var e=c(98128),f=c(48869),g=c(78868),h=c(37526),i=c(21884),j=c(261),k=c(24218),l=c(73640),m=c(66376),n=c(36363),o=c(73605),p=c(76583),q=c(19465),r=c(78910),s=c(86439),t=c(48724),u=c(54172),v=a([u]);u=(v.then?(await v)():v)[0];let y=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/spaces/[spaceId]/chat/intent/route",pathname:"/api/spaces/[spaceId]/chat/intent",filename:"route",bundlePath:"app/api/spaces/[spaceId]/chat/intent/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/Users/laneyfraass/Desktop/HIVE/apps/web/src/app/api/spaces/[spaceId]/chat/intent/route.ts",nextConfigOutput:"",userland:u}),{workAsyncStorage:z,workUnitAsyncStorage:A,serverHooks:B}=y;function w(){return(0,g.patchFetch)({workAsyncStorage:z,workUnitAsyncStorage:A})}async function x(a,b,c){var d;let e="/api/spaces/[spaceId]/chat/intent/route";"/index"===e&&(e="/");let g=await y.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(z.dynamicRoutes[E]||z.routes[D]);if(F&&!x){let a=!!z.routes[D],b=z.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||y.isDev||x||(G=D,G="/index"===G?"/":G);let H=!0===y.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:z,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>y.onRequestError(a,b,d,A)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>y.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await y.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await y.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(b instanceof s.NoFallbackError||await y.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}d()}catch(a){d(a)}})},40649:(a,b,c)=>{c.d(b,{QW:()=>f,CL:()=>g,BS:()=>h});var d=c(81611),e=c(97338);function f(a,b){try{switch(a.type){case"poll":var c=a.params,f=b;if(!c.question||!c.options||c.options.length<2)return{success:!1,needsConfirmation:!0,confirmationMessage:"I detected a poll request. What question would you like to ask, and what options should voters choose from?"};let e=d.n.createPoll({spaceId:f.spaceId,boardId:f.boardId,messageId:f.messageId,createdBy:f.createdBy,question:c.question,options:c.options,allowMultiple:c.allowMultiple??!1,showResults:"always"});return e.isFailure?{success:!1,error:e.error||"Failed to create poll"}:{success:!0,component:e.getValue()};case"rsvp":var g=a.params,h=b;if(!g.eventTitle)return{success:!1,needsConfirmation:!0,confirmationMessage:"I detected an RSVP request. What is the name of the event?"};let k=g.eventDate||new Date(Date.now()+6048e5),l=d.n.createRsvp({spaceId:h.spaceId,boardId:h.boardId,messageId:h.messageId,createdBy:h.createdBy,eventTitle:g.eventTitle,eventDate:k,maxCapacity:g.maxCapacity,allowMaybe:!0});return l.isFailure?{success:!1,error:l.error||"Failed to create RSVP"}:{success:!0,component:l.getValue()};case"countdown":var i=a.params,j=b;if(!i.title||!i.targetDate)return{success:!1,needsConfirmation:!0,confirmationMessage:"I detected a countdown request. What should I count down to, and when is the target date?"};if(i.targetDate<=new Date)return{success:!1,error:"Countdown target date must be in the future"};let m=d.n.createCountdown({spaceId:j.spaceId,boardId:j.boardId,messageId:j.messageId,createdBy:j.createdBy,title:i.title,targetDate:i.targetDate,showDays:!0,showHours:!0,showMinutes:!0,showSeconds:!0});return m.isFailure?{success:!1,error:m.error||"Failed to create countdown"}:{success:!0,component:m.getValue()};case"announcement":return{success:!1,error:"Announcements are styled messages, not components",needsConfirmation:!1};default:return{success:!1,error:"No component intent detected"}}}catch(b){return e.v.error("Failed to create component from intent",{component:"intent-to-component",intentType:a.type,error:b instanceof Error?b.message:"Unknown error"}),{success:!1,error:b instanceof Error?b.message:"Failed to create component"}}}function g(a,b){if(!a.isValid)return{success:!1,error:a.error||"Invalid command"};try{switch(a.command){case"poll":let e;var c=a,f=b;let{parsed:k}=c;k.closesIn&&k.closesIn>0&&(e=new Date(Date.now()+60*k.closesIn*1e3));let l=d.n.createPoll({spaceId:f.spaceId,boardId:f.boardId,messageId:f.messageId,createdBy:f.createdBy,question:k.question,options:k.options,allowMultiple:k.allowMultiple,showResults:k.anonymous?"after_close":"always",closesAt:e});return l.isFailure?{success:!1,error:l.error||"Failed to create poll"}:{success:!0,component:l.getValue()};case"rsvp":var g=a,h=b;let{parsed:m}=g,n=m.eventDate||new Date(Date.now()+6048e5),o=d.n.createRsvp({spaceId:h.spaceId,boardId:h.boardId,messageId:h.messageId,createdBy:h.createdBy,eventTitle:m.eventTitle,eventDate:n,maxCapacity:m.maxCapacity,allowMaybe:m.allowMaybe});return o.isFailure?{success:!1,error:o.error||"Failed to create RSVP"}:{success:!0,component:o.getValue()};case"countdown":var i=a,j=b;let{parsed:p}=i;if(p.targetDate<=new Date)return{success:!1,error:"Countdown target date must be in the future"};let q=d.n.createCountdown({spaceId:j.spaceId,boardId:j.boardId,messageId:j.messageId,createdBy:j.createdBy,title:p.title,targetDate:p.targetDate,showDays:p.showDays,showHours:p.showHours,showMinutes:p.showMinutes,showSeconds:p.showSeconds});return q.isFailure?{success:!1,error:q.error||"Failed to create countdown"}:{success:!0,component:q.getValue()};case"announce":return{success:!1,error:"Announcements are styled messages, not inline components"};case"help":return{success:!1,error:"Help command does not create a component"};default:return{success:!1,error:`Unknown command: ${a.command}`}}}catch(b){return e.v.error("Failed to create component from command",{component:"intent-to-component",commandType:a.command,error:b instanceof Error?b.message:"Unknown error"}),{success:!1,error:b instanceof Error?b.message:"Failed to create component"}}}function h(a,b){if("type"in a)switch(a.type){case"poll":if(a.params.question)return`Creating poll: "${a.params.question}" with ${a.params.options?.length||0} options`;return"Creating a poll";case"rsvp":if(a.params.eventTitle)return`Creating RSVP for: "${a.params.eventTitle}"`;return"Creating an RSVP";case"countdown":if(a.params.title)return`Creating countdown to: "${a.params.title}"`;return"Creating a countdown";default:return"Creating component"}switch(a.command){case"poll":return`Creating poll: "${a.parsed.question}" with ${a.parsed.options.length} options`;case"rsvp":return`Creating RSVP for: "${a.parsed.eventTitle}"`;case"countdown":return`Creating countdown to: "${a.parsed.title}"`;default:return"Creating component"}}},44870:a=>{a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},46675:a=>{a.exports=require("firebase-admin")},54172:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{POST:()=>q});var e=c(54760),f=c(91714),g=c(94205),h=c(12665),i=c(29655),j=c(93629),k=c(40649),l=c(38929),m=a([g]);g=(m.then?(await m)():m)[0];let p=e.Ik({message:e.Yj().min(1).max(4e3),boardId:e.Yj().min(1),createIfDetected:e.zM().default(!1),messageId:e.Yj().optional()}),q=(0,g.SH)(p,async(a,{params:b},c,d)=>{let{spaceId:e}=await b,m=(0,g.F6)(a),p=(0,g.rE)(a);if(!e)return d.error("Space ID is required","INVALID_INPUT",{status:400});let q=await (0,h.Ku)(e,m,"member");if(!q.hasPermission)return d.error("Not authorized to access this space","UNAUTHORIZED",{status:403});let r="owner"===q.role||"admin"===q.role,s=q.space?.name,t=q.space?.category;if((0,j.isSlashCommand)(c.message))return n(c,e,m,p,r,d);let u=await (0,i.parseIntent)(c.message,{spaceName:s,spaceCategory:t,isLeader:r});if(!(0,i.shouldCreateComponent)(u))return d.success({hasIntent:!1,intentType:"none",confidence:u.confidence,message:"No component creation intent detected"});if(!r)return d.success({hasIntent:!0,intentType:u.type,confidence:u.confidence,preview:(0,i.C)(u),canCreate:!1,message:"Only space leaders can create inline components"});if(!c.createIfDetected)return d.success({hasIntent:!0,intentType:u.type,confidence:u.confidence,preview:(0,i.C)(u),params:u.params,canCreate:!0,confirmation:(0,i.C)(u)});let v=c.messageId||o(),w=(0,k.QW)(u,{spaceId:e,boardId:c.boardId,messageId:v,createdBy:m});if(!w.success)return w.needsConfirmation?d.success({hasIntent:!0,intentType:u.type,confidence:u.confidence,needsMoreInfo:!0,confirmationMessage:w.confirmationMessage}):d.error(w.error||"Failed to create component","CREATE_FAILED",{status:400});let x=w.component,y=x.toDTO();try{return await l.dbAdmin.collection("spaces").doc(e).collection("boards").doc(c.boardId).collection("inline_components").doc(x.id).set({...y,creationSource:"chat_intent",creationPrompt:c.message,campusId:p}),f.vF.info("Inline component created via intent",{component:"intent-api",componentId:x.id,componentType:u.type,spaceId:e,boardId:c.boardId,userId:m}),d.success({hasIntent:!0,intentType:u.type,confidence:u.confidence,created:!0,component:{id:x.id,type:x.componentType,config:x.config},description:(0,k.BS)(u,"chat_intent")},{status:201})}catch(a){return f.vF.error("Failed to persist component",{component:"intent-api",error:a instanceof Error?a.message:"Unknown error",spaceId:e,boardId:c.boardId}),d.error("Failed to save component","PERSIST_FAILED",{status:500})}});async function n(a,b,c,d,e,g){let h=(0,j.parseSlashCommand)(a.message);if("help"===h.command){let a=(0,j.nS)(h.parsed.topic);return g.success({hasIntent:!0,intentType:"help",isCommand:!0,helpText:a})}if(!h.isValid)return g.success({hasIntent:!0,intentType:h.command,isCommand:!0,isValid:!1,error:h.error,helpText:(0,j.nS)(h.command)});if(!e)return g.success({hasIntent:!0,intentType:h.command,isCommand:!0,isValid:!0,canCreate:!1,message:"Only space leaders can create inline components"});if(!a.createIfDetected)return g.success({hasIntent:!0,intentType:h.command,isCommand:!0,isValid:!0,canCreate:!0,preview:(0,k.BS)(h,"slash_command")});let i=a.messageId||o(),m=(0,k.CL)(h,{spaceId:b,boardId:a.boardId,messageId:i,createdBy:c});if(!m.success)return g.error(m.error||"Failed to create component","CREATE_FAILED",{status:400});let n=m.component,p=n.toDTO();try{return await l.dbAdmin.collection("spaces").doc(b).collection("boards").doc(a.boardId).collection("inline_components").doc(n.id).set({...p,creationSource:"slash_command",creationPrompt:a.message,campusId:d}),f.vF.info("Inline component created via slash command",{component:"intent-api",componentId:n.id,componentType:h.command,spaceId:b,boardId:a.boardId,userId:c}),g.success({hasIntent:!0,intentType:h.command,isCommand:!0,created:!0,component:{id:n.id,type:n.componentType,config:n.config},description:(0,k.BS)(h,"slash_command")},{status:201})}catch(c){return f.vF.error("Failed to persist component",{component:"intent-api",error:c instanceof Error?c.message:"Unknown error",spaceId:b,boardId:a.boardId}),g.error("Failed to save component","PERSIST_FAILED",{status:500})}}function o(){return`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}d()}catch(a){d(a)}})},55511:a=>{a.exports=require("crypto")},57975:a=>{a.exports=require("node:util")},63033:a=>{a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:a=>{a.exports=require("http2")},74075:a=>{a.exports=require("zlib")},77598:a=>{a.exports=require("node:crypto")},79551:a=>{a.exports=require("url")},81611:(a,b,c)=>{c.d(b,{n:()=>f});var d=c(95624),e=c(19789);class f extends d.w{get spaceId(){return this.props.spaceId}get boardId(){return this.props.boardId}get messageId(){return this.props.messageId}get componentType(){return this.props.componentType}get elementType(){return this.props.elementType}get toolId(){return this.props.toolId}get config(){return this.props.config}get sharedState(){return this.props.sharedState}get isActive(){return this.props.isActive}get createdBy(){return this.props.createdBy}get createdAt(){return this.props.createdAt}get updatedAt(){return this.props.updatedAt}get version(){return this.props.version}constructor(a,b){super(a,b||`comp_${crypto.randomUUID()}`)}static createPoll(a){if(!a.question||0===a.question.trim().length)return e.Q.fail("Poll question is required");if(!a.options||a.options.length<2)return e.Q.fail("Poll requires at least 2 options");if(a.options.length>10)return e.Q.fail("Poll cannot have more than 10 options");let b=[...new Set(a.options.map(a=>a.trim()).filter(a=>a.length>0))];if(b.length<2)return e.Q.fail("Poll requires at least 2 unique options");let c={question:a.question.trim(),options:b,allowMultiple:a.allowMultiple??!1,showResults:a.showResults??"always",closesAt:a.closesAt},d={};return b.forEach(a=>{d[a]=0}),e.Q.ok(new f({spaceId:a.spaceId,boardId:a.boardId,messageId:a.messageId,componentType:"poll",elementType:"poll-element",toolId:"quick-poll",config:c,sharedState:{optionCounts:d,totalResponses:0},isActive:!0,createdBy:a.createdBy,createdAt:new Date,updatedAt:new Date,version:1}))}static createCountdown(a){if(!a.title||0===a.title.trim().length)return e.Q.fail("Countdown title is required");if(!a.targetDate||a.targetDate<=new Date)return e.Q.fail("Countdown target date must be in the future");let b={title:a.title.trim(),targetDate:a.targetDate,showDays:a.showDays??!0,showHours:a.showHours??!0,showMinutes:a.showMinutes??!0,showSeconds:a.showSeconds??!0};return e.Q.ok(new f({spaceId:a.spaceId,boardId:a.boardId,messageId:a.messageId,componentType:"countdown",elementType:"countdown-timer",toolId:"quick-countdown",config:b,sharedState:{totalResponses:0},isActive:!0,createdBy:a.createdBy,createdAt:new Date,updatedAt:new Date,version:1}))}static createRsvp(a){if(!a.eventTitle||0===a.eventTitle.trim().length)return e.Q.fail("Event title is required");if(!a.eventDate)return e.Q.fail("Event date is required");let b={eventId:a.eventId,eventTitle:a.eventTitle.trim(),eventDate:a.eventDate,maxCapacity:a.maxCapacity,allowMaybe:a.allowMaybe??!0};return e.Q.ok(new f({spaceId:a.spaceId,boardId:a.boardId,messageId:a.messageId,componentType:"rsvp",elementType:"rsvp-button",toolId:"quick-rsvp",config:b,sharedState:{rsvpCounts:{yes:0,no:0,maybe:0},totalResponses:0},isActive:!0,createdBy:a.createdBy,createdAt:new Date,updatedAt:new Date,version:1}))}static createCustom(a){if(!a.elementType)return e.Q.fail("Element type is required");if(!a.toolId)return e.Q.fail("Tool ID is required");let b={elementType:a.elementType,toolId:a.toolId,settings:a.settings??{}};return e.Q.ok(new f({spaceId:a.spaceId,boardId:a.boardId,messageId:a.messageId,componentType:"custom",elementType:a.elementType,toolId:a.toolId,config:b,sharedState:{totalResponses:0},isActive:!0,createdBy:a.createdBy,createdAt:new Date,updatedAt:new Date,version:1}))}recordPollVote(a,b,c){if("poll"!==this.props.componentType)return e.Q.fail("This is not a poll component");if(!this.props.isActive)return e.Q.fail("This poll is no longer active");let d=this.props.config,f=b.filter(a=>d.options.includes(a));if(0===f.length)return e.Q.fail("No valid options selected");if(!d.allowMultiple&&f.length>1)return e.Q.fail("This poll only allows one selection");if(d.closesAt&&d.closesAt<=new Date)return e.Q.fail("This poll has closed");let g={userId:a,selectedOptions:f,participatedAt:new Date},h={isNewParticipant:!c};return c?.selectedOptions?.length&&(h.decrementOption=c.selectedOptions[0]),h.incrementOption=f[0],e.Q.ok({participantRecord:g,aggregationDelta:h})}recordRsvp(a,b,c){if("rsvp"!==this.props.componentType)return e.Q.fail("This is not an RSVP component");if(!this.props.isActive)return e.Q.fail("This RSVP is no longer active");let d=this.props.config;if("maybe"===b&&!d.allowMaybe)return e.Q.fail("Maybe responses are not allowed");if("yes"===b&&d.maxCapacity){let a=this.props.sharedState.rsvpCounts?.yes??0;if(c?.response!=="yes"&&a>=d.maxCapacity)return e.Q.fail("This event is at capacity")}let f={userId:a,response:b,participatedAt:new Date},g={isNewParticipant:!c,rsvpChange:{from:c?.response,to:b}};return e.Q.ok({participantRecord:f,aggregationDelta:g})}recordCustomParticipation(a,b,c){if(!this.props.isActive)return e.Q.fail("This component is no longer active");let d={userId:a,data:b,participatedAt:new Date};return e.Q.ok({participantRecord:d,aggregationDelta:{isNewParticipant:!c}})}getDisplayState(a){return{componentId:this.id,elementType:this.props.elementType,config:this.props.config,aggregations:this.computeSharedState(),userParticipation:a,isActive:this.props.isActive,createdBy:this.props.createdBy,createdAt:this.props.createdAt,version:this.props.version}}computeSharedState(){let a={...this.props.sharedState};if("countdown"===this.props.componentType){let b=this.props.config,c=new Date,d=b.targetDate.getTime()-c.getTime();if(d<=0)a.timeRemaining={days:0,hours:0,minutes:0,seconds:0,isComplete:!0};else{let b=Math.floor(d/864e5),c=Math.floor(d%864e5/36e5);a.timeRemaining={days:b,hours:c,minutes:Math.floor(d%36e5/6e4),seconds:Math.floor(d%6e4/1e3),isComplete:!1}}}return a}close(){this.props.isActive=!1,this.props.updatedAt=new Date,this.props.version+=1}reactivate(){this.props.isActive=!0,this.props.updatedAt=new Date,this.props.version+=1}applyDelta(a){a.incrementOption&&this.props.sharedState.optionCounts&&(this.props.sharedState.optionCounts[a.incrementOption]=(this.props.sharedState.optionCounts[a.incrementOption]??0)+1),a.decrementOption&&this.props.sharedState.optionCounts&&(this.props.sharedState.optionCounts[a.decrementOption]=Math.max(0,(this.props.sharedState.optionCounts[a.decrementOption]??0)-1)),a.rsvpChange&&this.props.sharedState.rsvpCounts&&(a.rsvpChange.from&&(this.props.sharedState.rsvpCounts[a.rsvpChange.from]=Math.max(0,this.props.sharedState.rsvpCounts[a.rsvpChange.from]-1)),this.props.sharedState.rsvpCounts[a.rsvpChange.to]+=1),a.isNewParticipant&&(this.props.sharedState.totalResponses+=1),this.props.updatedAt=new Date,this.props.version+=1}toDTO(){return{id:this.id,spaceId:this.props.spaceId,boardId:this.props.boardId,messageId:this.props.messageId,componentType:this.props.componentType,elementType:this.props.elementType,toolId:this.props.toolId,config:this.serializeConfig(this.props.config),sharedState:this.props.sharedState,isActive:this.props.isActive,createdBy:this.props.createdBy,createdAt:this.props.createdAt.toISOString(),updatedAt:this.props.updatedAt.toISOString(),version:this.props.version}}serializeConfig(a){let b={...a};return"targetDate"in a&&a.targetDate instanceof Date&&(b.targetDate=a.targetDate.toISOString()),"eventDate"in a&&a.eventDate instanceof Date&&(b.eventDate=a.eventDate.toISOString()),"closesAt"in a&&a.closesAt instanceof Date&&(b.closesAt=a.closesAt.toISOString()),b}static fromDTO(a){try{let b=f.deserializeConfig(a.componentType,a.config);return e.Q.ok(new f({spaceId:a.spaceId,boardId:a.boardId,messageId:a.messageId,componentType:a.componentType,elementType:a.elementType,toolId:a.toolId,config:b,sharedState:a.sharedState,isActive:!!a.isActive,createdBy:a.createdBy,createdAt:new Date(a.createdAt),updatedAt:new Date(a.updatedAt),version:a.version||1},a.id))}catch(a){return e.Q.fail("Failed to reconstruct InlineComponent from DTO")}}static deserializeConfig(a,b){switch(a){case"poll":return{question:b.question,options:b.options,allowMultiple:!!b.allowMultiple,showResults:b.showResults||"always",closesAt:b.closesAt?new Date(b.closesAt):void 0};case"countdown":return{title:b.title,targetDate:new Date(b.targetDate),showDays:!!(b.showDays??!0),showHours:!!(b.showHours??!0),showMinutes:!!(b.showMinutes??!0),showSeconds:!!(b.showSeconds??!0)};case"rsvp":return{eventId:b.eventId,eventTitle:b.eventTitle,eventDate:new Date(b.eventDate),maxCapacity:b.maxCapacity,allowMaybe:!!(b.allowMaybe??!0)};default:return{elementType:b.elementType,toolId:b.toolId,settings:b.settings??{}}}}}},81630:a=>{a.exports=require("http")},86439:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external")},91645:a=>{a.exports=require("net")},93629:(a,b,c)=>{c.d(b,{isSlashCommand:()=>f,nS:()=>k,parseSlashCommand:()=>g});let d=["poll","rsvp","countdown","announce","automate","welcome","remind","help"],e={poll:{syntax:'/poll "Question?" Option1 Option2 [Option3...] [--multiple] [--anonymous] [--closes=<minutes>]',description:"Create a poll for members to vote on",examples:['/poll "Best meeting day?" Monday Tuesday Wednesday','/poll "Favorite pizza?" Pepperoni Cheese Veggie --multiple','/poll "President election" Alice Bob --anonymous --closes=60']},rsvp:{syntax:'/rsvp "Event Name" [--date=<date>] [--limit=<number>] [--maybe] [--deadline=<date>]',description:"Create an RSVP for an event",examples:['/rsvp "Study Session"','/rsvp "End of Year Party" --date=2024-12-20 --limit=50','/rsvp "Workshop" --date=tomorrow --maybe --deadline=2024-12-15']},countdown:{syntax:'/countdown "Event Name" <date> [--no-days] [--no-hours] [--no-minutes] [--no-seconds]',description:"Create a countdown timer to a date/time",examples:['/countdown "Finals Week" 2024-12-16','/countdown "Spring Break" 2025-03-15T00:00','/countdown "Meeting" tomorrow --no-seconds']},announce:{syntax:"/announce <message> [--pin] [--urgent]",description:"Post an announcement to the space",examples:["/announce Meeting moved to Room 201","/announce New member guidelines posted! --pin","/announce Elections starting now! --urgent"]},automate:{syntax:'/automate <type> "Name" [config]',description:"Create a custom automation",examples:['/automate welcome "New Member Greeting"','/automate reminder "Event Reminder" --before=30','/automate keyword "FAQ Bot" --keywords="hours,schedule"']},welcome:{syntax:'/welcome "Message" [--delay=<seconds>] [--board=<boardId>]',description:"Set up automatic welcome messages for new members",examples:['/welcome "Welcome to our club! Check out #events for upcoming activities"','/welcome "Hey {member}! Introduce yourself in #general" --delay=30']},remind:{syntax:'/remind <minutes> ["Message"] [--board=<boardId>]',description:"Set up event reminders for all events",examples:["/remind 30",'/remind 60 "Don\'t forget about {event}!"',"/remind 15 --board=events"]},help:{syntax:"/help [command]",description:"Show help for slash commands",examples:["/help","/help poll","/help automate"]},unknown:{syntax:"",description:"Unknown command",examples:[]}};function f(a){return a.trim().startsWith("/")}function g(a){let b=a.trim();if(!b.startsWith("/"))return j(a,"Message must start with /");let c=b.indexOf(" "),e=(c>0?b.slice(1,c):b.slice(1)).toLowerCase(),f=c>0?b.slice(c+1).trim():"";if(!d.includes(e))return j(a,`Unknown command: /${e}. Try /help for available commands.`);switch(e){case"poll":var g=f,k=a;let{quoted:l,positional:m,flags:n}=h(g),o=l[0];if(!o)return{command:"poll",args:m,flags:n,raw:k,isValid:!1,error:'Poll question required. Use: /poll "Question?" Option1 Option2',parsed:{question:"",options:[],allowMultiple:!1,anonymous:!1}};let p=m.filter(a=>a.length>0);return p.length<2?{command:"poll",args:m,flags:n,raw:k,isValid:!1,error:'Poll needs at least 2 options. Use: /poll "Question?" Option1 Option2',parsed:{question:o,options:p,allowMultiple:!1,anonymous:!1}}:p.length>10?{command:"poll",args:m,flags:n,raw:k,isValid:!1,error:"Poll cannot have more than 10 options.",parsed:{question:o,options:p,allowMultiple:!1,anonymous:!1}}:{command:"poll",args:m,flags:n,raw:k,isValid:!0,parsed:{question:o,options:p,allowMultiple:!!n.multiple,anonymous:!!n.anonymous,closesIn:"number"==typeof n.closes?n.closes:void 0}};case"rsvp":return function(a,b){let c,d,e,{quoted:f,flags:g}=h(a),j=f[0];return j?(g.date&&(c=i(String(g.date))),g.deadline&&(d=i(String(g.deadline))),"number"==typeof g.limit?e=g.limit:"string"==typeof g.limit&&(e=parseInt(g.limit,10)||void 0),{command:"rsvp",args:[],flags:g,raw:b,isValid:!0,parsed:{eventTitle:j,eventDate:c,maxCapacity:e,allowMaybe:!1!==g.maybe,deadline:d}}):{command:"rsvp",args:[],flags:g,raw:b,isValid:!1,error:'Event title required. Use: /rsvp "Event Name"',parsed:{eventTitle:"",allowMaybe:!0}}}(f,a);case"countdown":var q=f,r=a;let{quoted:s,positional:t,flags:u}=h(q),v=s[0];if(!v)return{command:"countdown",args:t,flags:u,raw:r,isValid:!1,error:'Countdown title required. Use: /countdown "Title" <date>',parsed:{title:"",targetDate:new Date,showDays:!0,showHours:!0,showMinutes:!0,showSeconds:!0}};let w=t[0];if(!w)return{command:"countdown",args:t,flags:u,raw:r,isValid:!1,error:'Target date required. Use: /countdown "Title" 2024-12-20',parsed:{title:v,targetDate:new Date,showDays:!0,showHours:!0,showMinutes:!0,showSeconds:!0}};let x=i(w);return!x||isNaN(x.getTime())?{command:"countdown",args:t,flags:u,raw:r,isValid:!1,error:`Invalid date: ${w}. Use format like 2024-12-20 or "tomorrow"`,parsed:{title:v,targetDate:new Date,showDays:!0,showHours:!0,showMinutes:!0,showSeconds:!0}}:{command:"countdown",args:t,flags:u,raw:r,isValid:!0,parsed:{title:v,targetDate:x,showDays:!u["no-days"],showHours:!u["no-hours"],showMinutes:!u["no-minutes"],showSeconds:!u["no-seconds"]}};case"announce":var y=f,z=a;let{flags:A}=h(y),B=y.replace(/--\w+(?:=[^\s]+)?/g,"").trim();return B?{command:"announce",args:[B],flags:A,raw:z,isValid:!0,parsed:{content:B,pin:!!A.pin,urgent:!!A.urgent}}:{command:"announce",args:[],flags:A,raw:z,isValid:!1,error:"Announcement content required. Use: /announce <message>",parsed:{content:"",pin:!1,urgent:!1}};case"automate":var C=f,D=a;let{quoted:E,positional:F,flags:G}=h(C),H=F[0]?.toLowerCase(),I=["welcome","reminder","keyword","schedule"];if(!H||!I.includes(H))return{command:"automate",args:F,flags:G,raw:D,isValid:!1,error:`Invalid automation type. Use: /automate <${I.join("|")}> "Name"`,parsed:{automationType:"welcome",name:""}};let J=E[0];return J?{command:"automate",args:F,flags:G,raw:D,isValid:!0,parsed:{automationType:H,name:J,triggerConfig:G,actionConfig:{}}}:{command:"automate",args:F,flags:G,raw:D,isValid:!1,error:'Automation name required. Use: /automate welcome "Name"',parsed:{automationType:H,name:""}};case"welcome":let K;var L=f,M=a;let{quoted:N,flags:O}=h(L),P=N[0];if(!P)return{command:"welcome",args:[],flags:O,raw:M,isValid:!1,error:'Welcome message required. Use: /welcome "Your message here"',parsed:{message:""}};"number"==typeof O.delay?K=O.delay:"string"==typeof O.delay&&(K=parseInt(O.delay,10)||void 0);let Q="string"==typeof O.board?O.board:void 0;return{command:"welcome",args:[],flags:O,raw:M,isValid:!0,parsed:{message:P,delay:K,boardId:Q}};case"remind":return function(a,b){let{quoted:c,positional:d,flags:e}=h(a),f=d[0],g=parseInt(f,10);if(!f||isNaN(g)||g<1||g>10080)return{command:"remind",args:d,flags:e,raw:b,isValid:!1,error:"Reminder minutes required (1-10080). Use: /remind 30",parsed:{beforeMinutes:30}};let i=c[0],j="string"==typeof e.board?e.board:void 0;return{command:"remind",args:d,flags:e,raw:b,isValid:!0,parsed:{beforeMinutes:g,message:i,boardId:j}}}(f,a);case"help":var R=f,S=a;let T=R.trim().toLowerCase(),U=d.includes(T)?T:void 0;return{command:"help",args:U?[U]:[],flags:{},raw:S,isValid:!0,parsed:{topic:U}};default:return j(a,"Unhandled command type")}}function h(a){let b,c=[],d=[],e={},f=a,g=/"([^"]+)"/g;for(;null!==(b=g.exec(a));)c.push(b[1]),f=f.replace(b[0]," ");for(let a of f.split(/\s+/).filter(a=>a.length>0))if(a.startsWith("--")){let b=a.slice(2),c=b.indexOf("=");if(c>0){let a=b.slice(0,c),d=b.slice(c+1),f=parseFloat(d);e[a]=isNaN(f)?d:f}else e[b]=!0}else d.push(a);return{quoted:c,positional:d,flags:e}}function i(a){let b=a.toLowerCase().trim(),c=new Date;if("tomorrow"===b){let a=new Date(c);return a.setDate(a.getDate()+1),a.setHours(12,0,0,0),a}if("today"===b){let a=new Date(c);return a.setHours(23,59,0,0),a}if("next week"===b){let a=new Date(c);return a.setDate(a.getDate()+7),a.setHours(12,0,0,0),a}let d=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].indexOf(b);if(-1!==d){let a=new Date(c),b=d-a.getDay();return b<=0&&(b+=7),a.setDate(a.getDate()+b),a.setHours(12,0,0,0),a}try{let b=new Date(a);if(!isNaN(b.getTime()))return b}catch{}}function j(a,b){return{command:"unknown",args:[],flags:{},raw:a,isValid:!1,error:b}}function k(a){if(a&&"unknown"!==a){let b=e[a];return[`**/${a}**`,b.description,"","**Syntax:**",`\`${b.syntax}\``,"","**Examples:**",...b.examples.map(a=>`\`${a}\``)].join("\n")}return["**Available Commands:**","",...d.filter(a=>"unknown"!==a).map(a=>{let b=e[a];return`â€¢ **/${a}** - ${b.description}`}),"","Type `/help <command>` for detailed usage."].join("\n")}},94735:a=>{a.exports=require("events")},95624:(a,b,c)=>{c.d(b,{w:()=>d});class d{constructor(a,b){this._id=b,this.props=a}get id(){return this._id}equals(a){return!!a&&a instanceof d&&this._id===a._id}}}};var b=require("../../../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[7545,1684,5524,2845,4760,9613,2626,9405,3272,2269,4205],()=>b(b.s=39521));module.exports=c})();